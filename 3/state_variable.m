clc;
clear;
Sigma=[ 2.1241    1.0055    0.1290  131.1380];
Rho=[0.0862    0.1820    0.3244    1.5248];
%P=[-1+1.9*j -9 -1-1.9*j -27];
P=[-4+3*j -1.5 -4-3*j -28];
M1=[1 -Rho(2);-Sigma(1) 1];
M2=[-Rho(3) 0;0 -Sigma(3)];
M3=[0 0;0 Sigma(4)];
M4=[Rho(4);0];
M1inv=inv(M1);
A1=M1inv*M2;
A2=M1inv*M3;
B1=M1inv*M4;

A=[0 0 1 0
   0 0 0 1
   A2(1,1) A2(1,2) A1(1,1) A1(1,2)
   A2(2,1) A2(2,2) A1(2,1) A1(2,2)];

% A=[0 0 1 0
%    0 0 0 1
%    0 -7.1247 -0.0963 0
%    0 59.3267 0.0741 0];
B=[0
   0
   B1(1,1)
   B1(2,1)];
eig(A);
rank([B A*B A^2*B A^3*B])
K=place(A,B,P)
K1=K(1,1);
K2=-K(1,2);
K3=K(1,3);
K4=-K(1,4);
% fine tune
% K1=-4.06;
% K2=-98.27;
% K3=-2.9;
% K4=-9.62;

